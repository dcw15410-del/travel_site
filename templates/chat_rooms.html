{% extends "base.html" %}
{% block title %}채팅방 목록 - TravelSite{% endblock %}
{% block content %}
<div class="container mt-4">
    <h2>채팅방 목록</h2>
    <ul class="list-group">
        {% for room in chat_rooms %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <a href="{{ url_for('chat', room=room) }}">{{ room }}</a>
            <span class="badge bg-primary rounded-pill" id="count-{{ room }}">0</span>
        </li>
        {% endfor %}
    </ul>
</div>

{% block extra_script %}
<script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
<script>
const socket = io();

// 인원 수 업데이트 받기
socket.on("update_user_count", data => {
    const el = document.getElementById("count-" + data.room);
    if(el) el.textContent = data.count;
});
</script>
{% endblock %}
{% endblock %}
