<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>{{ room }} 채팅방</title>
    <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
    <style>
        body { font-family: Arial; }
        #chat { width: 80%; margin: auto; }
        #messages { border: 1px solid #ccc; height: 400px; overflow-y: scroll; padding: 5px; }
    </style>
</head>
<body>
    <h2>{{ room }} 채팅방</h2>
    <div id="chat">
        <ul id="messages"></ul>
        <input id="msg" autocomplete="off">
        <button onclick="sendMessage()">전송</button>
    </div>

    <script>
        var socket = io();
        var room = "{{ room }}";

        socket.emit("join", {room: room, user: "{{ user.nickname }}"});

        socket.on("receive_message", function(data) {
            var li = document.createElement("li");
            li.textContent = "["+data.time+"] "+data.user+": "+data.msg;
            document.getElementById("messages").appendChild(li);
        });

        function sendMessage() {
            var msg = document.getElementById("msg").value;
            socket.emit("send_message", {room: room, msg: msg});
            document.getElementById("msg").value = "";
        }
    </script>
</body>
</html>
